{% extends "base.html" %}
{% block content %}

<div class="page">

    <!-- ============================= -->
    <!-- Top navigation -->
    <!-- ============================= -->
<div class="top-nav">
    <img src="/static/images/back.png"
         class="nav-btn left"
         alt="Back"
         onclick="navBack()">

    <img src="/static/images/home.png"
         class="nav-btn right"
         alt="Home"
         onclick="navHome()">
</div>


    <h1>EDID Tools</h1>

    <!-- ============================= -->
    <!-- EDID Controls -->
    <!-- ============================= -->
    <div class="controls">

        <div class="control-group">
            <label for="port">Port:</label>
            <select id="port" name="port">
                <!-- populated by JS -->
            </select>

            <button onclick="loadConnectors(true)">↻ Refresh Ports</button>
        </div>

        <div class="control-group">
            <button onclick="readEdid()">Read EDID</button>
            <button onclick="resetView()">Reset</button>
        </div>

    </div>

    <!-- ============================= -->
    <!-- Status / Match -->
    <!-- ============================= -->
    <div id="status" class="status">Idle</div>
    <div id="match" class="match"></div>

    <!-- ============================= -->
    <!-- EDID Output -->
    <!-- ============================= -->
    <pre id="output" class="output"></pre>

    <!-- ============================= -->
    <!-- View Mode Toggle -->
    <!-- ============================= -->
    <div class="toggle">
        <label>
            <input
                type="radio"
                name="viewMode"
                value="binary"
                checked
                onchange="switchView()"
            >
            Binary
        </label>

        <label>
            <input
                type="radio"
                name="viewMode"
                value="decoded"
                onchange="switchView()"
            >
            Decoded
        </label>
    </div>

    <!-- ============================= -->
    <!-- Save EDID -->
    <!-- ============================= -->
    <div class="save">
        <label for="saveFilename">Save as:</label>
        <input
            id="saveFilename"
            type="text"
            placeholder="filename.bin"
        >
        <button
            id="saveBtn"
            onclick="saveEdid()"
            disabled
        >
            Save EDID
        </button>
    </div>

    <!-- ============================= -->
    <!-- USB Import / Export -->
    <!-- ============================= -->
	<div class="usb-section">
		<h3>USB Import / Export</h3>

		<div class="usb-controls">
			<select id="usbDrive"></select>
			<button onclick="loadUsbDrives()">↻ Refresh USB</button>
		</div>

		<div id="usbFiles" class="usb-files"></div>

		<div class="usb-actions">
			<button onclick="importEdids()">Import selected</button>
			<button onclick="exportEdids()">Export selected</button>
		</div>

		<div id="usbStatus" class="status"></div>
	</div>

    <!-- ============================= -->
    <!-- USB Import / Export -->
    <!-- ============================= -->
	<div class="write-section">
		<h3>Write EDID to Device</h3>

		<label>Saved EDID file:</label>
		<select id="edidFile" onchange="onFileSelect()">
			<option value="">-- select EDID --</option>
		</select>

		<button id="writeBtn" onclick="writeEdid()" disabled>
			⚠ Write EDID
		</button>
	</div>

</div>

<!-- ============================= -->
<!-- Scripts -->
<!-- ============================= -->
<script src="{{ url_for('static', filename='js/edid.js') }}"></script>

{% endblock %}
